<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Selection language &#8212; Chemfiles 0.10.0
 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/chemfiles.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Configuration files" href="configuration.html" />
    <link rel="prev" title="Supported formats" href="formats.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Chemfiles</a>
        <span class="navbar-text navbar-version pull-left"><b>0.10</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Navigation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-tutorials.html">C++ Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="c-tutorials.html">C Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats.html">Supported formats</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Selection language</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="properties.html">Properties</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="classes/index.html">C++ interface reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="capi/index.html">C interface reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="devdoc/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="devdoc/internals.html">Chemfiles internals</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="formats.html" title="Previous Chapter: Supported formats"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Supported formats</span>
    </a>
  </li>
  <li>
    <a href="configuration.html" title="Next Chapter: Configuration files"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Configuration files &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-tutorials.html">C++ Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="c-tutorials.html">C Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats.html">Supported formats</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Selection language</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#selection-language-reference">Selection language reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="properties.html">Properties</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="classes/index.html">C++ interface reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="capi/index.html">C interface reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="devdoc/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="devdoc/internals.html">Chemfiles internals</a></li>
</ul>

<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="selection-language">
<span id="id1"></span><h1>Selection language<a class="headerlink" href="#selection-language" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Chemfiles implements a rich selection language that allows finding the atoms
matching a set of constraints in a <a class="reference internal" href="classes/frame.html#_CPPv4N9chemfiles5FrameE" title="chemfiles::Frame"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">Frame</span></code></a>.  For
example, <code class="docutils literal notranslate"><span class="pre">atom:</span> <span class="pre">name</span> <span class="pre">==</span> <span class="pre">H</span> <span class="pre">and</span> <span class="pre">x</span> <span class="pre">&gt;</span> <span class="pre">15</span></code> would select all atoms with a name equal
to “H” and x cartesian coordinate bigger than 15. Here, <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">==</span> <span class="pre">H</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&gt;</span>
<span class="pre">15</span></code> are individual constraints, and they are combined with <code class="docutils literal notranslate"><span class="pre">and</span></code>, meaning
both of them must be true for an atom to match to full selection.</p>
<p>Chemfiles atomic selection language differs from other atomic selection
languages (such as the ones in <a class="reference external" href="https://www.ks.uiuc.edu/Research/vmd/current/ug/node89.html">VMD</a>, <a class="reference external" href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html">MDAnalysis</a>, and many others) by the
fact that it is possible to formulate constraints not only on single atoms, but
also on pairs, triplets, and quadruplets of atoms. For example, <code class="docutils literal notranslate"><span class="pre">angles:</span>
<span class="pre">name(#2)</span> <span class="pre">O</span> <span class="pre">and</span> <span class="pre">mass(#3)</span> <span class="pre">&lt;</span> <span class="pre">1.5</span></code> will select all sets of three bonded atoms
forming an angle such that the name of the second atom is O and the mass of the
third atom is less than 1.5. Here, the first atom is left unconstrained.  Where
evaluating simple selections yields a list of matching atomic indexes,
evaluating triplet selection will return a list of triplets of atomic indexes
(and correspondingly for pairs and quadruplets).</p>
<p>The number of atoms to select together is indicated in chemfiles by a context,
separated from the main selection by a colon. Seven contexts are available:
<code class="docutils literal notranslate"><span class="pre">atoms</span></code> is the default context, matching single atoms. <code class="docutils literal notranslate"><span class="pre">two</span></code>, <code class="docutils literal notranslate"><span class="pre">three</span></code>, and
<code class="docutils literal notranslate"><span class="pre">four</span></code> match arbitrary pairs, triplets and quadruplets of atoms respectively.
<code class="docutils literal notranslate"><span class="pre">bonds</span></code>, <code class="docutils literal notranslate"><span class="pre">angles</span></code>, and <code class="docutils literal notranslate"><span class="pre">dihedrals</span></code> match pairs, triplets and quadruplets
of atoms bonded together to form the corresponding connectivity element.</p>
<div class="section" id="expressing-the-constraints">
<h3>Expressing the constraints<a class="headerlink" href="#expressing-the-constraints" title="Permalink to this headline">¶</a></h3>
<p>Selections are built by assembling simple constraints with the Boolean operators
<code class="docutils literal notranslate"><span class="pre">and</span></code>, <code class="docutils literal notranslate"><span class="pre">or</span></code> and <code class="docutils literal notranslate"><span class="pre">not</span></code>. They follow the usual interpretation of logic: <code class="docutils literal notranslate"><span class="pre">A</span>
<span class="pre">and</span> <span class="pre">B</span></code> will be true only if both A and B are true, <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">or</span> <span class="pre">B</span></code> will be true if
one of A or B is, and <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">A</span></code> will be true is A is false. You can use three
types of constraints in your selections: Boolean constraints, string constraints,
and numeric constraints.</p>
<p>String constraints check text values, such as the atomic <code class="docutils literal notranslate"><span class="pre">name</span></code> or atomic
<code class="docutils literal notranslate"><span class="pre">type</span></code>, comparing it to a fixed value: <code class="docutils literal notranslate"><span class="pre">name(#1)</span> <span class="pre">==</span> <span class="pre">Fe</span></code>. When using a
selection with more than one atom, constraints are applied to different atoms
using <code class="docutils literal notranslate"><span class="pre">#1</span></code>, <code class="docutils literal notranslate"><span class="pre">#2</span></code>, <code class="docutils literal notranslate"><span class="pre">#3</span></code> or <code class="docutils literal notranslate"><span class="pre">#4</span></code> to refer to a specific atom: <code class="docutils literal notranslate"><span class="pre">angles:</span>
<span class="pre">name(#3)</span> <span class="pre">Co</span></code> will check the name of the third atom of the angles, and so on.</p>
<p>Numeric constraints check numeric values such as the position of the atoms
(<code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, and <code class="docutils literal notranslate"><span class="pre">z</span></code>), the atomic <code class="docutils literal notranslate"><span class="pre">mass</span></code>, the <code class="docutils literal notranslate"><span class="pre">index</span></code> of an atom in the
frame, <em>etc.</em> Numeric values can be combined with the usual mathematical
operations: <code class="docutils literal notranslate"><span class="pre">x^2</span> <span class="pre">+</span> <span class="pre">y^2</span> <span class="pre">+</span> <span class="pre">z^2</span> <span class="pre">&lt;</span> <span class="pre">10^2</span></code> will check for atoms inside the sphere
with a radius of 10 Å centered on the origin. The usual <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code> and
<code class="docutils literal notranslate"><span class="pre">/</span></code> operators are supported, as well as <code class="docutils literal notranslate"><span class="pre">^</span></code> for exponentiation and <code class="docutils literal notranslate"><span class="pre">%</span></code> for
modulo (remainder of Euclidean division). These operations follow the standard
priority rules: <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">3</span></code> is 7, not 9. Numeric values are then compared with
one of <code class="docutils literal notranslate"><span class="pre">==</span></code> (equal), <code class="docutils literal notranslate"><span class="pre">!=</span></code> (not equal), <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> (less than),
<code class="docutils literal notranslate"><span class="pre">&lt;=</span></code> (less or equal), <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> (more than), or <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> (more or equal).</p>
<p>Finally, Boolean constraints directly evaluate to either <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>
for a given set of atoms. For example, <code class="docutils literal notranslate"><span class="pre">is_bonded(i,</span> <span class="pre">j)</span></code> will check if atoms i
and j are bonded together. Here, <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> can either be one of the atoms
currently being matched (<code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>) or another selection (called
sub-selection). In the latter case, all the atoms in the sub-selection are
checked to see if any of them verify the selection. This makes <code class="docutils literal notranslate"><span class="pre">is_bonded(#1,</span>
<span class="pre">name</span> <span class="pre">O)</span></code> select all atoms bonded to an oxygen; and <code class="docutils literal notranslate"><span class="pre">is_angle(type</span> <span class="pre">C,</span> <span class="pre">#1,</span> <span class="pre">name</span>
<span class="pre">O)</span></code> select all atoms in the middle of a C-X-O angle.</p>
</div>
<div class="section" id="constraints-on-atomic-or-residue-properties">
<h3>Constraints on atomic or residue properties<a class="headerlink" href="#constraints-on-atomic-or-residue-properties" title="Permalink to this headline">¶</a></h3>
<p>It is possible to use atomic <a class="reference internal" href="classes/property.html#_CPPv4N9chemfiles8PropertyE" title="chemfiles::Property"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">properties</span></code></a>
(unfortunately not frame properties) in constraints, with the <code class="docutils literal notranslate"><span class="pre">[&lt;property&gt;]</span></code>
syntax. <code class="docutils literal notranslate"><span class="pre">&lt;property&gt;</span></code> should be replaced by the property name: <code class="docutils literal notranslate"><span class="pre">[is_hetatm]</span></code>,
possibly using quotes around the property name if it contains spaces: <code class="docutils literal notranslate"><span class="pre">[&quot;my</span> <span class="pre">own</span>
<span class="pre">property&quot;]</span></code>. Depending on the context, a Boolean, string or numeric property
will be searched. If an atomic property with a given name cannot be found,
residue properties are searched instead, however, atomic properties take
precedence. If none can be found, or if the property type does not match, a
default value will be used instead: <code class="docutils literal notranslate"><span class="pre">false</span></code> for Boolean properties, <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>
(empty string) for string properties, and <code class="docutils literal notranslate"><span class="pre">NaN</span></code> for numeric properties.</p>
</div>
</div>
<div class="section" id="selection-language-reference">
<h2>Selection language reference<a class="headerlink" href="#selection-language-reference" title="Permalink to this headline">¶</a></h2>
<p>Here is the list of currently implemented constraints. Additional ideas are welcome!</p>
<div class="section" id="boolean-constraints">
<h3>Boolean constraints<a class="headerlink" href="#boolean-constraints" title="Permalink to this headline">¶</a></h3>
<p>Boolean constraints directly evaluate to <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>, and can be
combined with other constraints with <code class="docutils literal notranslate"><span class="pre">and</span></code>, <code class="docutils literal notranslate"><span class="pre">or</span></code> and <code class="docutils literal notranslate"><span class="pre">not</span></code>.</p>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="all"><a class="reference internal" href="#all"><code class="docutils literal notranslate"><span class="pre">all</span></code></a></span></p>
<p>Matches any atom and always evaluate to <code class="docutils literal notranslate"><span class="pre">true</span></code></p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="none"><a class="reference internal" href="#none"><code class="docutils literal notranslate"><span class="pre">none</span></code></a></span></p>
<p>Never matches an atom and always evaluate to <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="is-bonded-i-j"><a class="reference internal" href="#is-bonded-i-j"><code class="docutils literal notranslate"><span class="pre">is_bonded(i,</span> <span class="pre">j)</span></code></a></span></p>
<p>Check if atoms i and j are bonded together.</p>
<p>i and j can either be one of the atoms currently being matched (i.e. <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span>
<span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>); or a sub-selection (e.g. <code class="docutils literal notranslate"><span class="pre">is_bonded(#1,</span> <span class="pre">name</span> <span class="pre">O)</span></code>). In the
latter case, the constrain will be checked for all atoms returned by the
sub-selection, and evaluate to <code class="docutils literal notranslate"><span class="pre">true</span></code> if any of them matches.</p>
<p>If i and j refers to the same atom, this evaluates to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="is-angle-i-j-k"><a class="reference internal" href="#is-angle-i-j-k"><code class="docutils literal notranslate"><span class="pre">is_angle(i,</span> <span class="pre">j,</span> <span class="pre">k)</span></code></a></span></p>
<p>Check if atoms i, j and k are bonded together to form an angle, <em>i.e.</em> that
i is bonded to j and j is bonded to k.</p>
<p>i, j, and k can either be one of the atoms currently being matched (i.e.
<code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>); or a sub-selection (with the same behavior as
<code class="docutils literal notranslate"><span class="pre">is_bonded</span></code>).</p>
<p>If any of i, j or k refer to the same atom, <code class="docutils literal notranslate"><span class="pre">is_angle</span></code> evaluate to
<code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="is-dihedral-i-j-k-m"><a class="reference internal" href="#is-dihedral-i-j-k-m"><code class="docutils literal notranslate"><span class="pre">is_dihedral(i,</span> <span class="pre">j,</span> <span class="pre">k,</span> <span class="pre">m)</span></code></a></span></p>
<p>Check if atoms i, j, k and m are bonded together to form a dihedral angle,
<em>i.e.</em> that i is bonded to  j, j is bonded to k, and k is bonded to m.</p>
<p>i, j, k, and m can either be one of the atoms currently being matched (i.e.
<code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>); or a sub-selection (with the same behavior as
<code class="docutils literal notranslate"><span class="pre">is_bonded</span></code>).</p>
<p>If any of i, j, k or m refer to the same atom, <code class="docutils literal notranslate"><span class="pre">is_dihedral</span></code> evaluate to
<code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="is-improper-i-j-k-m"><a class="reference internal" href="#is-improper-i-j-k-m"><code class="docutils literal notranslate"><span class="pre">is_improper(i,</span> <span class="pre">j,</span> <span class="pre">k,</span> <span class="pre">m)</span></code></a></span></p>
<p>Check if atoms i, j, k and m are bonded together to form a dihedral angle,
<em>i.e.</em> that all of i, k, and m are bonded to j.</p>
<p>If any of i, j, k or m refer to the same atom, <code class="docutils literal notranslate"><span class="pre">is_improper</span></code> evaluate to
<code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="property-property-i"><a class="reference internal" href="#property-property-i"><code class="docutils literal notranslate"><span class="pre">[&lt;property&gt;]</span></code> / <code class="docutils literal notranslate"><span class="pre">[&lt;property&gt;](#i)</span></code></a></span></p>
<p>Check if atoms or residues they belong to have a Boolean property named
<code class="docutils literal notranslate"><span class="pre">'property'</span></code>, and that this property is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This will evaluate to <code class="docutils literal notranslate"><span class="pre">false</span></code> if the property does not exist.</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
</div>
<div class="section" id="string-constraints">
<h3>String constraints<a class="headerlink" href="#string-constraints" title="Permalink to this headline">¶</a></h3>
<p>String constraints are compared to a literal value for either equality with
<code class="docutils literal notranslate"><span class="pre">constrain</span> <span class="pre">==</span> <span class="pre">value</span></code>, or inequality with <code class="docutils literal notranslate"><span class="pre">constrain</span> <span class="pre">!=</span> <span class="pre">value</span></code>. Values
without spaces, starting with an ASCII letter and using only ASCII letters and
numbers can be written directly (<code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">==</span> <span class="pre">Fe</span></code>, <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">!=</span> <span class="pre">ALA</span></code>), other
values must be surrounded by quotation marks: <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">==</span> <span class="pre">&quot;17&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">!=</span> <span class="pre">&quot;a</span>
<span class="pre">long</span> <span class="pre">name&quot;</span></code>.</p>
<p>For string selectors, <code class="docutils literal notranslate"><span class="pre">constrain</span> <span class="pre">value</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">constrain</span> <span class="pre">==</span>
<span class="pre">value</span></code>, and <code class="docutils literal notranslate"><span class="pre">constrain</span> <span class="pre">value1</span> <span class="pre">value2</span> <span class="pre">value3</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">constrain</span> <span class="pre">==</span>
<span class="pre">value1</span> <span class="pre">or</span> <span class="pre">constrain</span> <span class="pre">==</span> <span class="pre">value2</span> <span class="pre">or</span> <span class="pre">constrain</span> <span class="pre">==</span> <span class="pre">value3</span></code>. This simplifies common
selections, such as <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">H</span> <span class="pre">O</span> <span class="pre">C</span> <span class="pre">N</span></code>.</p>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="type-type-i"><a class="reference internal" href="#type-type-i"><code class="docutils literal notranslate"><span class="pre">type</span></code> / <code class="docutils literal notranslate"><span class="pre">type(#i)</span></code></a></span></p>
<p>Evaluates to the atomic type of the atom being checked.</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="name-name-i"><a class="reference internal" href="#name-name-i"><code class="docutils literal notranslate"><span class="pre">name</span></code> / <code class="docutils literal notranslate"><span class="pre">name(#i)</span></code></a></span></p>
<p>Evaluates to the atomic name of the atom being checked. Some formats store
both an atomic name (e.g. H3) and an atom type (e.g. H), this is why you can
use two different selectors depending on the actual data;</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="resname-resname-i"><a class="reference internal" href="#resname-resname-i"><code class="docutils literal notranslate"><span class="pre">resname</span></code> / <code class="docutils literal notranslate"><span class="pre">resname(#i)</span></code></a></span></p>
<p>Evaluates to the name of the <a class="reference internal" href="classes/residue.html#_CPPv4N9chemfiles7ResidueE" title="chemfiles::Residue"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">chemfiles::Residue</span></code></a> containing the
atom being checked. If an atom is not in a residue, this evaluates to the
empty string.</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="property-property-i"><a class="reference internal" href="#property-property-i"><code class="docutils literal notranslate"><span class="pre">[&lt;property&gt;]</span></code> / <code class="docutils literal notranslate"><span class="pre">[&lt;property&gt;](#i)</span></code></a></span></p>
<p>If the atom being matched or the residue it belongs to (if any) have a
string property named <code class="docutils literal notranslate"><span class="pre">'property'</span></code>, this evaluates to the value of the
property.  Else this evaluates to an empty string (<code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>).</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
</div>
<div class="section" id="numeric-constraints">
<h3>Numeric constraints<a class="headerlink" href="#numeric-constraints" title="Permalink to this headline">¶</a></h3>
<p>Numeric constraints can be combined using all of the usual numeric operations:
<code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">/</span></code>; as well as <code class="docutils literal notranslate"><span class="pre">^</span></code> for exponentiation and <code class="docutils literal notranslate"><span class="pre">%</span></code> for
modulo (remainder of Euclidean division). Parenthesis can be used for grouping
operations.</p>
<p>Additionally, mathematical functions are available to transform a number to
another value. Currently supported functions are: <code class="docutils literal notranslate"><span class="pre">deg2rad</span></code> and <code class="docutils literal notranslate"><span class="pre">rad2deg</span></code>
functions for transforming radians to degrees and respectively; <code class="docutils literal notranslate"><span class="pre">sin</span></code>,
<code class="docutils literal notranslate"><span class="pre">cos</span></code>, <code class="docutils literal notranslate"><span class="pre">tan</span></code> for the trigonometric functions (taking radians as input);
<code class="docutils literal notranslate"><span class="pre">asin</span></code> and <code class="docutils literal notranslate"><span class="pre">acos</span></code> inverse trigonometric functions (giving output in
radians); <code class="docutils literal notranslate"><span class="pre">sqrt</span></code> for square root; <code class="docutils literal notranslate"><span class="pre">exp</span></code> for base <em>e</em> exponential; <code class="docutils literal notranslate"><span class="pre">log</span></code>
for the natural or base <em>e</em> logarithm; <code class="docutils literal notranslate"><span class="pre">log2</span></code> for the base 2 logarithm and
<code class="docutils literal notranslate"><span class="pre">log10</span></code> for the base 10 logarithm. If you need another of such mathematical
function, <a class="reference external" href="https://github.com/chemfiles/chemfiles/issues/new/choose">open an issue</a> in the chemfiles repository!</p>
<p>Numeric values are finally compared using one of <code class="docutils literal notranslate"><span class="pre">==</span></code> (equal), <code class="docutils literal notranslate"><span class="pre">!=</span></code> (not
equal), <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> (greater), <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> (greater or equal), <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> (lesser), or <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>
(lesser or equal). They can be compared with one another (<code class="docutils literal notranslate"><span class="pre">(x^2</span> <span class="pre">+</span> <span class="pre">z)</span> <span class="pre">&gt;</span> <span class="pre">y</span></code>) or
with literal values (<code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">&lt;=</span> <span class="pre">1.24e-1</span></code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Numeric selection operate on double precision floating point number, and as
such are subject to the same limitations. In particular, while <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">==</span>
<span class="pre">3</span></code> will match all atoms, since this relation is always true, <code class="docutils literal notranslate"><span class="pre">0.1</span> <span class="pre">+</span> <span class="pre">0.2</span> <span class="pre">==</span>
<span class="pre">0.3</span></code> will match no atoms, since <code class="docutils literal notranslate"><span class="pre">0.1</span> <span class="pre">+</span> <span class="pre">0.2</span> <span class="pre">==</span> <span class="pre">0.30000000000000004</span></code> when
using floating point arithmetic.</p>
</div>
<p>Here are all the available numeric values</p>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="index-index-i"><a class="reference internal" href="#index-index-i"><code class="docutils literal notranslate"><span class="pre">index</span></code> / <code class="docutils literal notranslate"><span class="pre">index(#i)</span></code></a></span></p>
<p>Evaluates to the atomic index of the atom being matched.</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="mass-mass-i"><a class="reference internal" href="#mass-mass-i"><code class="docutils literal notranslate"><span class="pre">mass</span></code> / <code class="docutils literal notranslate"><span class="pre">mass(#i)</span></code></a></span></p>
<p>Evaluates to the mass of the atom being matched. For atoms with a type from
the periodic table, the element mass is used as default. The atom mass can
also be set manually, either directly with
<a class="reference internal" href="classes/atom.html#_CPPv4N9chemfiles4Atom8set_massEd" title="chemfiles::Atom::set_mass"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">chemfiles::Atom::set_mass()</span></code></a>, or using a <a class="reference internal" href="configuration.html#configuration"><span class="std std-ref">configuration file</span></a>.</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="x-y-z-x-i-y-i-z-i"><a class="reference internal" href="#x-y-z-x-i-y-i-z-i"><code class="docutils literal notranslate"><span class="pre">x</span></code> / <code class="docutils literal notranslate"><span class="pre">y</span></code> / <code class="docutils literal notranslate"><span class="pre">z</span></code> / <code class="docutils literal notranslate"><span class="pre">x(#i)</span></code> / <code class="docutils literal notranslate"><span class="pre">y(#i)</span></code> / <code class="docutils literal notranslate"><span class="pre">z(#i)</span></code></a></span></p>
<p>Evaluates to the cartesian component of the position of the atom being
matched, in Ångströms.</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="vx-vy-vz-vx-i-vy-i-vz-i"><a class="reference internal" href="#vx-vy-vz-vx-i-vy-i-vz-i"><code class="docutils literal notranslate"><span class="pre">vx</span></code> / <code class="docutils literal notranslate"><span class="pre">vy</span></code> / <code class="docutils literal notranslate"><span class="pre">vz</span></code> / <code class="docutils literal notranslate"><span class="pre">vx(#i)</span></code> / <code class="docutils literal notranslate"><span class="pre">vy(#i)</span></code> / <code class="docutils literal notranslate"><span class="pre">vz(#i)</span></code></a></span></p>
<p>Evaluates to the cartesian component of the velocity of the atom being
matched. If velocities are not defined in the <a class="reference internal" href="classes/frame.html#_CPPv4N9chemfiles5FrameE" title="chemfiles::Frame"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">chemfiles::Frame</span></code></a>
being matched, this evaluates to <a class="reference external" href="https://en.wikipedia.org/wiki/Na">NaN</a>.</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="resid-resid-i"><a class="reference internal" href="#resid-resid-i"><code class="docutils literal notranslate"><span class="pre">resid</span></code> / <code class="docutils literal notranslate"><span class="pre">resid(#i)</span></code></a></span></p>
<p>Evaluates to the id of the <a class="reference internal" href="classes/residue.html#_CPPv4N9chemfiles7ResidueE" title="chemfiles::Residue"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">chemfiles::Residue</span></code></a> containing the
atom being checked. If an atom is not in a residue, or if the residue do not
have an id, this evaluates to -1.</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="property-property-i"><a class="reference internal" href="#property-property-i"><code class="docutils literal notranslate"><span class="pre">[&lt;property&gt;]</span></code> / <code class="docutils literal notranslate"><span class="pre">[&lt;property&gt;](#i)</span></code></a></span></p>
<p>If the atom being matched or the residue it belongs to (if any) have a
numeric property named <code class="docutils literal notranslate"><span class="pre">'property'</span></code>, this evaluates to the value of the
property. Else this evaluates to <a class="reference external" href="https://en.wikipedia.org/wiki/Na">NaN</a>.</p>
<p>If multiple atoms are being matched simultaneously, the one to check can be
specified by setting <code class="docutils literal notranslate"><span class="pre">#i</span></code> to one of <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>. If <code class="docutils literal notranslate"><span class="pre">#i</span></code> is
not specified, <code class="docutils literal notranslate"><span class="pre">#1</span></code> is checked by default.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="distance-i-j"><a class="reference internal" href="#distance-i-j"><code class="docutils literal notranslate"><span class="pre">distance(i,</span> <span class="pre">j)</span></code></a></span></p>
<p>Evaluates to the distance in Ångströms between atoms i and j, accounting
for periodic boundary conditions.</p>
<p>i and j can either be one of the atoms currently being matched (i.e. <code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span>
<span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>); or a sub-selection (<code class="docutils literal notranslate"><span class="pre">distance(#1,</span> <span class="pre">name</span> <span class="pre">O)</span></code>). In the case
of a sub-selection, the distance will be evaluated for all atoms matching
the sub-selection, and then propagated through mathematical operations. In
the end, the atoms will be considered a match if <strong>any</strong> of the values is a
match. So <code class="docutils literal notranslate"><span class="pre">distance(#1,</span> <span class="pre">name</span> <span class="pre">O)</span> <span class="pre">+</span> <span class="pre">3</span> <span class="pre">&lt;</span> <span class="pre">5</span></code> will return all atoms at less
than 2Å from <strong>any</strong> atom with name O.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="angle-i-j-k"><a class="reference internal" href="#angle-i-j-k"><code class="docutils literal notranslate"><span class="pre">angle(i,</span> <span class="pre">j,</span> <span class="pre">k)</span></code></a></span></p>
<p>Evaluates to the angle between atoms i, j and k in radians, accounting for
periodic boundary conditions. The atoms do not need to be bonded together.</p>
<p>i, j, and k can either be one of the atoms currently being matched (i.e.
<code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>); or a sub-selections. In the latter case,
mathematical operations are combined as for <code class="docutils literal notranslate"><span class="pre">distance(i,</span> <span class="pre">j)</span></code>.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="dihedral-i-j-k-m"><a class="reference internal" href="#dihedral-i-j-k-m"><code class="docutils literal notranslate"><span class="pre">dihedral(i,</span> <span class="pre">j,</span> <span class="pre">k,</span> <span class="pre">m)</span></code></a></span></p>
<p>Evaluates to the dihedral angle between atoms i, j, k and m in radians,
accounting for periodic boundary conditions. The atoms do not need to be
bonded together.</p>
<p>i, j, k and m can either be one of the atoms currently being matched (i.e.
<code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>); or a sub-selections. In the latter case,
mathematical operations are combined as for <code class="docutils literal notranslate"><span class="pre">distance(i,</span> <span class="pre">j)</span></code>.</p>
</div>
<div class="chemfiles-selection admonition">
<p class="admonition-title"><span class="target" id="out-of-plane-i-j-k-m"><a class="reference internal" href="#out-of-plane-i-j-k-m"><code class="docutils literal notranslate"><span class="pre">out_of_plane(i,</span> <span class="pre">j,</span> <span class="pre">k,</span> <span class="pre">m)</span></code></a></span></p>
<p>Evaluates to  the distance in Ångströms between the plane formed by the three
atoms i, k, and m; and the atom j, accounting for periodic boundary
conditions.</p>
<p>i, j, k and m can either be one of the atoms currently being matched (i.e.
<code class="docutils literal notranslate"><span class="pre">#1</span> <span class="pre">/</span> <span class="pre">#2</span> <span class="pre">/</span> <span class="pre">#3</span> <span class="pre">/</span> <span class="pre">#4</span></code>); or a sub-selections. In the latter case,
mathematical operations are combined as for <code class="docutils literal notranslate"><span class="pre">distance(i,</span> <span class="pre">j)</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">angle</span></code> and <code class="docutils literal notranslate"><span class="pre">dihedral</span></code> constraints are different from the <code class="docutils literal notranslate"><span class="pre">is_angle</span></code>
and <code class="docutils literal notranslate"><span class="pre">is_dihedral</span></code>. The firsts returns a number that can then be used in
mathematical expressions, and can be used even if the atoms are not bonded
together in the corresponding topology elements.</p>
<p>The seconds directly evaluate to <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>, and only check if
the atoms are bonded together in the corresponding topology elements.</p>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
  <footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
    </p>
    <p class="pull-left">
        &copy; Copyright Guillaume Fraux and contributors.
    </p>
    <p class="text-center">
        BSD licensed on <a href="https://github.com/chemfiles/chemfiles">Github</a>
    </p>
  </div>
</footer>

  </body>
</html>